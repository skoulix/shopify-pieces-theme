import{P as d}from"./pieces-Piece.js";import{g as t}from"./pieces-app.js";class o extends d{constructor(){super("ProductCard",{stylesheets:[]})}mount(){this.$image=this.$("img")[0],this.$secondaryImage=this.$("[data-secondary-image]")[0],this.$title=this.$("[data-product-title]")[0],this.$price=this.$("[data-product-price]")[0],this.$quickAdd=this.$("[data-quick-add]")[0],this.on("mouseenter",this,this.handleMouseEnter),this.on("mouseleave",this,this.handleMouseLeave),this.$quickAdd&&this.on("click",this.$quickAdd,this.handleQuickAdd),this.hasAttribute("data-reveal")&&t.set(this,{opacity:0,y:30})}unmount(){this.off("mouseenter",this,this.handleMouseEnter),this.off("mouseleave",this,this.handleMouseLeave),this.$quickAdd&&this.off("click",this.$quickAdd,this.handleQuickAdd)}handleMouseEnter(){this.$image&&t.to(this.$image,{scale:1.05,duration:.6,ease:"power2.out"}),this.$secondaryImage&&t.to(this.$secondaryImage,{opacity:1,duration:.4}),this.$quickAdd&&t.to(this.$quickAdd,{opacity:1,y:0,duration:.3,ease:"power2.out"})}handleMouseLeave(){this.$image&&t.to(this.$image,{scale:1,duration:.6,ease:"power2.out"}),this.$secondaryImage&&t.to(this.$secondaryImage,{opacity:0,duration:.4}),this.$quickAdd&&t.to(this.$quickAdd,{opacity:0,y:10,duration:.3})}handleQuickAdd(s){s.preventDefault(),s.stopPropagation();const e=this.$quickAdd.dataset.variantId,a=parseInt(this.$quickAdd.dataset.quantity)||1;if(!e){console.warn("No variant ID found for quick add");return}this.$quickAdd.classList.add("is-loading"),fetch(window.routes.cart_add_url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:e,quantity:a})}).then(i=>i.json()).then(i=>{this.$quickAdd.classList.remove("is-loading"),this.$quickAdd.classList.add("is-added"),this.emit("cart:add",document,{item:i}),setTimeout(()=>{this.$quickAdd.classList.remove("is-added")},2e3)}).catch(i=>{console.error("Error adding to cart:",i),this.$quickAdd.classList.remove("is-loading"),this.$quickAdd.classList.add("is-error"),setTimeout(()=>{this.$quickAdd.classList.remove("is-error")},2e3)})}reveal(s=0){t.to(this,{opacity:1,y:0,duration:.6,delay:s,ease:"power2.out"})}}customElements.define("c-product-card",o);export{o as default};
//# sourceMappingURL=pieces-ProductCard.js.map
